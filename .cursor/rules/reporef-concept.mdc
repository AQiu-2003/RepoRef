---
description: 有关这个项目的目标与介绍
globs: 
alwaysApply: false
---
## 目标

- 帮助 agent 获取外部 仓库 的文件列表/具体文件内容，agent 可以通过多次调用这个接口逐渐理清事情的真相（文件夹结构、文件内容等），如果当前检索路径不对可以换个思路再试试
- 可以配置 git仓库的列表，他们都会克隆到一个固定的目录下，并且可以依据要求切换分支（只有配置指定的几条分支，因为不会做更改所以可以强制切换）
- agent 可以获取指定仓库指定分支下的目录结构和文件内容，只要提供仓库根目录的 src/ 下的文件即可

## 实现方案

1. 使用simple-git工具通用地管理仓库，将仓库文件存储在 ~/.repo-ref 文件夹下
2. 启动时（如果没有）在repo-ref文件夹根目录创建一个config.yml文件并打开，里面有注释掉的示例配置，以便用户填写需要的仓库链接、分支、默认入口和一些prompt等
3. 启动时如果发现config.yml文件，则根据配置项克隆这些仓库（并切换到第一条分支）；如果是以sse模式启动，需要将所有分支都克隆一遍，避免session冲突（因为此时可能运行在服务器上）
4. 可以指定仓库默认文件入口（一般为src），并为特定 文件路径 pattern 下的结果提供额外的 prompt
5. 在mcp服务器介绍中就列出可用仓库及别名
6. 提供MCP（Model Context Protocol）接口，使用tool接口提供全部能力：

### get_repo

- agent 需要传入仓库名，如果仓库名不对需要提供可用仓库名
- 传入仓库名正确时，返回可用分支列表，并携带对仓库和各分支的描述（从config.yml中读取）

### get_file_list

- agent 可以传入一个路径，也可以不传入；需要传入仓库和分支名
- 返回一个 json 数组，展示指定路径下的文件/文件夹，只展示当前层级的，文件有后缀名，文件夹末尾为斜杠/

### get_file_content

- agent 需要传入仓库、分支名、文件路径
- 返回指定文件的文件内容 raw，不是md后缀的文件使用md code 包裹